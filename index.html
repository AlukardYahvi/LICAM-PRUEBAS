<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Evaluaci√≥n de Carteles - Simposio M√©dico</title>
    
    <!-- Librer√≠a Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* CSS Base (styles.css integrado y mejorado) */
        :root{
            /* Colores inspirados en la identidad visual */
            --bg:#f9fafb; /* Fondo muy claro */
            --card:#ffffff;
            --muted:#6b7280;
            --primary-1:#5b21b6; /* Morado Oscuro/Vino */
            --primary-2:#8b5cf6; /* Morado Claro */
            --accent:#7c3aed;
            --success:#16a34a;
            --danger:#ef4444;
            --info:#3b82f6;
        }

        *{box-sizing:border-box;font-family:Inter,system-ui,Arial;margin:0;padding:0}
        
        /* C√ìDIGO PARA EL FONDO DE IMAGEN */
        body{
            /* 1. Usar la imagen de fondo */
            background-image: url('simposio_background.jpg');
            /* 2. Propiedades para cubrir toda la pantalla */
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: center center;
            /* 3. Fondo de color sutil para que el texto resalte */
            background-color: rgba(255, 255, 255, 0.85); 
            background-blend-mode: lighten; /* Mezcla el color blanco con la imagen */
            
            color:#0b1220; 
            min-height:100vh;
        }
        /* FIN C√ìDIGO FONDO DE IMAGEN */

        /* Correcci√≥n: Usa m√°s ancho de pantalla */
        .container{max-width:1280px; width: 98%; margin:32px auto;padding:18px} 
        .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px; padding-bottom: 16px; border-bottom: 1px solid #e5e7eb;}
        .topbar .logo{height:50px;margin-right:12px; border-radius: 8px;} /* Logos m√°s grandes y con borde suave */
        .topbar .version{color:var(--muted);font-size:13px; font-weight: 600; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 8px;}

        /* Correcci√≥n: Permite que el grid principal crezca */
        .main-grid{display:grid;grid-template-columns:360px 1fr;gap:24px;align-items:start} 
        
        /* AJUSTE PARA VISIBILIDAD DE TARJETAS SOBRE EL FONDO */
        .card{
            background: rgba(255, 255, 255, 0.95); /* Fondo blanco semitransparente */
            backdrop-filter: blur(2px); /* Un peque√±o blur para un efecto m√°s limpio */
            border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(12,16,40,0.08)
        } 
        /* FIN AJUSTE VISIBILIDAD */

        .login-card h2{font-size:24px;margin-bottom:8px; font-weight: 800;}
        .muted{color:var(--muted);font-size:13px;margin-bottom:12px}
        label{display:block;font-weight:600;margin-bottom:6px;font-size:13px}
        input,textarea,select{width:100%;padding:12px;border-radius:10px;border:1px solid #e6e9ef;margin-bottom:16px;font-size:14px; transition: border-color .2s}
        input:focus, textarea:focus, select:focus { border-color: var(--primary-2); outline: none; }

        .btn{display:inline-flex; align-items: center; justify-content: center; padding:12px 18px;border-radius:10px;border:none;cursor:pointer;font-weight:700; gap: 8px; transition: all .2s}
        .btn.primary{width:100%;color:white;background:linear-gradient(90deg,var(--primary-1),var(--primary-2));}
        .btn.primary:hover{box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);}
        .btn.ghost{background:transparent;border:1px solid #e6e9ef;color:var(--muted);}
        .btn.ghost:hover{background-color: #f3f4f6;}
        .btn.danger{background-color: var(--danger); color: white;}
        .btn.danger:hover{opacity: 0.9;}

        .error{color:var(--danger);margin-bottom:8px}
        .hidden{display:none}

        /* Estilos para el campo de contrase√±a y el bot√≥n de visibilidad */
        .password-container{position:relative; margin-bottom: 16px;}
        .password-container input{margin-bottom: 0;}
        .password-container .toggle-btn{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;padding:0;}

        .header-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
        .welcome{font-size:24px;font-weight:800; color: var(--primary-1);}
        .small{font-size:13px;color:var(--muted)}

        .work-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px} /* Ajuste a 250px */
        /* AJUSTE PARA VISIBILIDAD DE TARJETAS DE TRABAJO */
        .work-card{
            padding:15px;border-radius:12px;
            background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(251,251,255,0.9));
            border:1px solid #eef2ff; 
            transition: all .2s
        }
        .work-card:hover{box-shadow: 0 4px 15px rgba(0,0,0,0.1)}
        /* FIN AJUSTE VISIBILIDAD */

        .work-card strong{display:block;font-size:16px;margin-bottom:8px; color: #1f2937;}
        .work-meta{font-size:14px;color:#4b5563;}
        
        /* Dashboard Tabs */
        .tabs { display: flex; border-bottom: 2px solid #e5e7eb; margin-bottom: 16px; }
        .tab-button { 
            padding: 10px 15px; 
            cursor: pointer; 
            font-weight: 600; 
            color: var(--muted);
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }
        .tab-button.active { 
            color: var(--primary-1); 
            border-bottom: 3px solid var(--primary-1); 
        }


        .top-actions{display:flex;gap:10px;align-items:center}

        .evaluated-badge{display:inline-block;background:rgba(34,197,94,0.12);color:var(--success);padding:6px 10px;border-radius:999px;font-weight:700;font-size:13px}

        .form-row{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
        .form-row .full{grid-column:1/-1}

        /* Modal Styles */
        .modal-bg{position:fixed;inset:0;background:rgba(2,6,23,0.7);display:flex;align-items:center;justify-content:center;z-index:9999; backdrop-filter: blur(4px);}
        .modal{background:white;padding:24px;border-radius:16px;max-width:720px;width:96%;box-shadow:0 12px 40px rgba(8,10,30,0.3)}
        
        .progress{height:12px;background:#eef2ff;border-radius:999px;overflow:hidden}
        .progress > div{height:100%;background:linear-gradient(90deg,var(--primary-1),var(--primary-2)); transition: width 0.5s ease-out;}

        .admin-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}

        .footer{margin-top:32px;text-align:center;color:var(--muted);font-size:13px}
        
        /* Evaluation specific styles */
        .eval-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-bottom:20px}
        .eval-card{border:1px solid #e6e9ef; padding:15px; border-radius:10px; background-color: #f9f9ff;}
        .eval-card h4{font-weight:800; color:var(--primary-1); font-size:16px; margin-bottom: 6px;}
        .score-row{display:flex; justify-content:space-between; align-items:center; margin-top: 10px;}
        .score-input-custom{border:1px solid #ccc; padding: 6px 10px; width: 70px; text-align: center; border-radius: 6px; font-weight: 600;}
        .deduction{color:var(--danger);}
        .bonus{color:var(--success);}

        /* Button Score Styles */
        .score-buttons { display: flex; gap: 6px; align-items: center; }
        .score-btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background-color: #fff;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.1s;
            position: relative; /* Para el tooltip */
        }
        .score-btn.selected {
            border-width: 2px;
            border-color: var(--primary-1);
            background-color: #eef2ff;
            box-shadow: 0 0 5px rgba(91, 33, 182, 0.3);
        }
        .score-btn:hover { background-color: #f3f4f6; }
        
        /* Tooltip (Gu√≠a) */
        .score-btn .tooltip {
            visibility: hidden;
            background-color: var(--primary-1);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Posici√≥n encima del bot√≥n */
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            font-size: 12px;
            line-height: 1.2;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .score-btn:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        /* Custom Alert/Toast Styles */
        #custom-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10000;
            display: none; /* Hidden by default */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .alert-success { background-color: #d1fae5; color: var(--success); border: 1px solid #a7f3d0; }
        .alert-error { background-color: #fee2e2; color: var(--danger); border: 1px solid #fecaca; }
        .alert-info { background-color: #e0f2fe; color: var(--primary-1); border: 1px solid #bae6fd; }

        /* responsive */
        @media (max-width:900px){
            .main-grid{grid-template-columns:1fr; padding-bottom:60px}
            .login-card{order:2}
            .topbar .logo{height: 40px;}
        }

    </style>

    <script type="module">
        // ============================================================
        //  CONFIGURACI√ìN Y DATOS DE LA APLICACI√ìN
        // ============================================================

        // URL de tu Web App Google Apps Script
        const SHEETS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycby9qqSkEhodL44Wk-PsloCY7WDeJI3PVyyAAOymJKBrdBfg6mnl5MKYYfOXNFUg2Kin/exec";

        // Formato Imprimible Integrado
        const PRINTABLE_HTML_TEMPLATE = `
        <!DOCTYPE html>
        <html lang="es">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Hoja de Evaluaci√≥n Imprimible</title>
            <style>
                @page { size: A4; margin: 1cm; }
                body { font-family: Arial, sans-serif; line-height: 1.4; color: #333; padding: 10px; }
                h1 { font-size: 16pt; text-align: center; border-bottom: 2px solid #333; padding-bottom: 5px; margin-bottom: 15px; }
                h2 { font-size: 13pt; margin-top: 20px; border-bottom: 1px solid #999; padding-bottom: 3px; }
                h3 { font-size: 11pt; margin-top: 15px; margin-bottom: 5px; color: #555; }
                .header-info { margin-bottom: 15px; font-size: 10pt; border: 1px solid #ccc; padding: 10px; border-radius: 5px; }
                .header-info div { margin-bottom: 4px; }
                .criteria-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
                .criteria-table th, .criteria-table td { border: 1px solid #ddd; padding: 6px 8px; text-align: left; vertical-align: top; font-size: 9pt; }
                .criteria-table th { background-color: #f0f0f0; font-weight: bold; }
                .score-box { width: 50px; text-align: center; }
                .max-score { width: 50px; text-align: center; font-weight: bold; }
                .sub-criteria { font-size: 8pt; color: #666; display: block; margin-top: 2px; }
                .total-box { font-size: 12pt; text-align: right; padding: 10px 0; font-weight: bold; margin-top: 10px; border-top: 2px solid #333; }
                .signature-area { margin-top: 40px; display: flex; justify-content: space-between; font-size: 10pt; }
                .signature-area div { border-top: 1px solid #333; width: 45%; text-align: center; padding-top: 5px; }
                @media print { .no-print { display: none; } button { display: none; } }
            </style>
        </head>
        <body>
            <div class="no-print" style="text-align:center; padding: 20px;">
                <button onclick="window.print()" style="padding: 10px 20px; background-color: #5b21b6; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">üñ®Ô∏è Imprimir Hoja</button>
            </div>

            <h1>HOJA DE EVALUACI√ìN OFICIAL - SIMPOSIO 2025</h1>
            
            <div class="header-info">
                <div><strong>EVALUADOR:</strong> ________________________________________________</div>
                <div><strong>ID TRABAJO:</strong> ______________________ <strong>FECHA:</strong> _________________</div>
                <div><strong>EXPOSITOR:</strong> ________________________________________________</div>
                <div><strong>MODALIDAD:</strong> [ ] P√ìSTER [ ] ORAL</div>
            </div>

            <h2>A. P√ìSTER CIENT√çFICO (M√°x. 100 pts)</h2>
            <table class="criteria-table">
                <thead><tr><th>CRITERIO</th><th>PUNTAJE</th><th>M√ÅX</th></tr></thead>
                <tbody>
                    <tr><td colspan="3"><strong>I. Fondo (55 pts)</strong></td></tr>
                    <tr><td>T√≠tulo y Congruencia <span class="sub-criteria">Claridad, pertinencia. (0, 3, 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td>Introducci√≥n <span class="sub-criteria">Contextualizaci√≥n. (0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Metodolog√≠a <span class="sub-criteria">Dise√±o y procedimientos. (0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Resultados <span class="sub-criteria">Presentaci√≥n de datos. (0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Conclusiones <span class="sub-criteria">Consistencia. (0, 3, 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td colspan="3"><strong>II. Forma (35 pts)</strong></td></tr>
                    <tr><td>Banner y Elementos <span class="sub-criteria">Logos y requisitos. (0 o 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td>Dise√±o Visual <span class="sub-criteria">Equilibrio y tipograf√≠a. (0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Tablas y Gr√°ficas <span class="sub-criteria">Calidad y citaci√≥n. (0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td colspan="3"><strong>III. Referencias y Pres. (10 pts)</strong></td></tr>
                    <tr><td>Referencias <span class="sub-criteria">Formato adecuado. (0 o 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td>Defensa <span class="sub-criteria">Dominio y s√≠ntesis. (M√°x 5)</span></td><td></td><td class="max-score">5</td></tr>
                </tbody>
            </table>

            <h2>B. EXPOSICI√ìN ORAL (M√°x. 100 pts)</h2>
            <table class="criteria-table">
                <thead><tr><th>CRITERIO</th><th>PUNTAJE</th><th>M√ÅX</th></tr></thead>
                <tbody>
                    <tr><td colspan="3"><strong>I. Fondo (45 pts)</strong></td></tr>
                    <tr><td>Introducci√≥n <span class="sub-criteria">(0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Metodolog√≠a <span class="sub-criteria">(0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td>Resultados <span class="sub-criteria">(0, 5, 15)</span></td><td></td><td class="max-score">15</td></tr>
                    <tr><td colspan="3"><strong>II. Exposici√≥n y Material (50 pts)</strong></td></tr>
                    <tr><td>Claridad Mensaje <span class="sub-criteria">Organizaci√≥n l√≥gica. (0, 5, 10)</span></td><td></td><td class="max-score">10</td></tr>
                    <tr><td>Fluidez y Tiempo <span class="sub-criteria">Ritmo y ajuste. (0, 5, 10)</span></td><td></td><td class="max-score">10</td></tr>
                    <tr><td>Respuestas (Q&A) <span class="sub-criteria">Dominio del tema. (0, 5, 10)</span></td><td></td><td class="max-score">10</td></tr>
                    <tr><td>Material Visual <span class="sub-criteria">Dise√±o diapositivas. (0, 5, 10)</span></td><td></td><td class="max-score">10</td></tr>
                    <tr><td>T√≠tulo <span class="sub-criteria">(0, 3, 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td>Conclusiones <span class="sub-criteria">(0, 3, 5)</span></td><td></td><td class="max-score">5</td></tr>
                    <tr><td colspan="3"><strong>III. Referencias (5 pts)</strong></td></tr>
                    <tr><td>Referencias <span class="sub-criteria">(0 o 5)</span></td><td></td><td class="max-score">5</td></tr>
                </tbody>
            </table>

            <h2>C. MODIFICADORES</h2>
            <table class="criteria-table">
                <tbody>
                    <tr><td>Innovaci√≥n (Bonificaci√≥n) <span class="sub-criteria">Aporta nuevo conocimiento.</span></td><td class="score-box"></td><td class="max-score" style="color:green">+15</td></tr>
                    <tr><td>Manejo del Tiempo (Deducci√≥n) <span class="sub-criteria">Puntos de penalizaci√≥n (Se RESTAN).</span></td><td class="score-box"></td><td class="max-score" style="color:red">-10</td></tr>
                    <tr><td>Redacci√≥n/Ortograf√≠a (Deducci√≥n) <span class="sub-criteria">Puntos de penalizaci√≥n (Se RESTAN).</span></td><td class="score-box"></td><td class="max-score" style="color:red">-10</td></tr>
                </tbody>
            </table>

            <div class="total-box">PUNTAJE FINAL: ___________ / 100</div>

            <div style="margin-top: 20px;">
                <strong>Observaciones:</strong>
                <div style="height: 80px; border: 1px solid #ccc; margin-top: 5px;"></div>
            </div>

            <div class="signature-area">
                <div>Firma Evaluador</div>
                <div>Firma Expositor</div>
            </div>
        </body>
        </html>
        `;

        // --- users.js (A√±adiendo el nuevo juez) ---
        const USERS = [
          { user: "admin", pass: "Admin2025", name: "Administrador General", role: "admin" },
          { user: "araceli.hernandez", pass: "Simposio2025", name: "Araceli Hern√°ndez Zavala", role: "juez" },
          { user: "marycarmen.godinez", pass: "Simposio2025", name: "Marycarmen Godinez Victoria", role: "juez" },
          { user: "claudia.calzada", pass: "Simposio2025", name: "Claudia Camelia Calzada Mendoza", role: "juez" },
          { user: "paola.zarate", pass: "Simposio2025", name: "Paola Berenice Zarate Segura", role: "juez" },
          { user: "ivonne.maciel", pass: "Simposio2025", name: "Ivonne Maciel Arciniega Mart√≠nez", role: "juez" },
          { user: "aldo.resendiz", pass: "Simposio2025", name: "Aldo Arturo Res√©ndiz Albor", role: "juez" },
          { user: "javier.perez", pass: "Simposio2025", name: "Javier P√©rez Dur√°n", role: "juez" },
          { user: "paula.saldana", pass: "Simposio2025", name: "Paula Salda√±a", role: "juez" },
          { user: "elena.cruz", pass: "Simposio2025", name: "Elena de La Cruz Herrera Cogco", role: "juez" },
          { user: "nury.perez", pass: "Simposio2025", name: "Nury P√©rez Hern√°ndez", role: "juez" },
          { user: "enrique.mendez", pass: "Simposio2025", name: "Enrique M√©ndez-Bolaina", role: "juez" },
          { user: "edgar.cano", pass: "Simposio2025", name: "Edgar Cano Europa", role: "juez" },
          { user: "javier.flores", pass: "Simposio2025", name: "Javier Flores Estrada", role: "juez" },
          { user: "araceli.montoya", pass: "Simposio2025", name: "Araceli Montoya Estrada", role: "juez" },
          { user: "guillermo.ceballos", pass: "Simposio2025", name: "Guillermo M Ceballos Reyes", role: "juez" } // Nuevo juez oral
        ];

        // --- WORKS (Combinaci√≥n de carteles y orales) ---
        const POSTER_WORKS = {
          "II-008-PL-MC":"Monserrat Andrea Ortiz Cortes", "II-009-PL-MC":"Castillo Olvera Itzel Jimena", "II-010-PL-NT":"Edgar Valeria de la Cruz", "II-012-PL-MC":"Marisol Garay Contreras",
          "II-016-PL-NT":"Natalia Valeria Sillerico Illanes", "II-020-PL-NT":"Daniela Torres Velasco", "II-022-PL-NT":"Astrid Adamari De la Rosa Cordero", "II-024-PL-NT":"Sara Gabriela Guadarrama Tovar",
          "II-025-PL-NT":"Astrid Sophia Careaga Arceo", "II-027-PL-MC":"Elena Abigail P√©rez Ham", "II-029-PL-ET":"F√°tima Monserrat √Åvila Quintero", "II-032-PL-NT":"Paz Pe√±a Dana Paola",
          "II-033-PL-ET":"Mariana Berenice L√≥pez Arenas", "II-039-PL-MC":"Ana Camila Ram√≠rez Ortiz", "II-043-PL-NT":"Dilan Rodr√≠guez Lagos", "II-045-PL-NT":"Arianys Carolina Tovar Escobar",
          "II-048-PL-MC":"Anel Camacho Dorantes", "II-050-PL-NT":"Alberto Jaret Mej√≠a Meza", "II-051-PL-GE":"Yuleny Cervantes Fosado", "II-054-PL-NT":"Monserrat Bracho",
          "II-058-PL-NT":"Xaris L√≥pez Sol√≠s", "II-059-PL-NT":"Gillian Yazm√≠n Sosa Maldonado", "II-060-PL-GE":"Jos√© Juli√°n L√≥pez Hern√°ndez", "II-062-PL-NT":"Laura Alessandra Ram√≠rez V√°zquez",
          "II-064-PL-NT":"Anayeli Panzo Mayahua", "II-066-PL-NT":"Valery Rosales Rojas", "II-068-PL-PG":"Mar√≠a Elizabeth S√°nchez Romero", "II-075-PL-NT":"Negrete Ch√°vez Dalia Isamar",
          "II-076-PL-NT":"Axel Emanuel Moctezuma Garc√≠a", "II-086-PL-ET":"Erick Santiago Mendoza Palacios", "II-089-PL-ET":"Jessamyn Reyna Crespo Sandoval", "II-091-PL-ET":"Joslay Cabrera Caballero",
          "II-094-PL-NT":"Anaya Herrera Vania", "II-095-PL-ET":"Merary Jael Diaz Espinoza", "II-096-PL-ET":"Nadia Meritxell Vargas Freyre", "II-098-PL-NT":"Valeria Yareli Salazar Segura",
          "II-001-PP-NT":"Alexis Alejandro Garc√≠a Rivero", "II-002-PP-NT":"Antonio √Åvila Guerrero", "II-003-PP-NT":"Yara Irene L√≥pez Dionicio", "II-004-PP-NT":"Romina Mar√≠a Valladares Ocampo",
          "II-006-PP-GE":"Juan Pablo Gonz√°lez Dom√≠nguez", "II-007-PP-NT":"Israel Lara Vega", "II-011-PP-PG":"Ivonne del Socorro Guti√©rrez Ruiz", "II-013-PP-GE":"Giselle Barrera Z√°rate",
          "II-014-PP-GE":"Jos√© Luis Marroqu√≠n Caratachea", "II-015-PP-PG":"Ram√≥n L√≥pez Ocampo", "II-019-PP-ET":"Rogelio Iv√°n G√≥mez Escobedo", "II-023-PP-GE":"Itzel Feria Figueroa",
          // ESTE TRABAJO SE MUEVE A ORAL
          "II-044-PP-ET":"Luis Mario S√°nchez Palestino", "II-047-PP-NT":"V√≠ctor Jes√∫s Escudero Huerta", "II-049-PP-ET":"Ernesto Santill√°n Arcos",
          "II-053-PP-GE":"Sally Silva Castro", "II-055-PP-MC":"Angelica Casta√±eda de la Fuente", "II-057-PP-NT":"Goretti Araneth L√≥pez Villafa√±a", "II-061-PP-NT":"Luis Armando Garc√≠a Pedraza",
          "II-069-PP-NT":"Guillermina Chavaro Francisco", "II-070-PP-NT":"Mar√≠a de los √Ångeles Rodr√≠guez Garc√≠a", "II-072-PP-NT":"Karla Reyes Alvarado", "II-081-PP-NT":"Stefany Alamilla Cuellar",
          "II-082-PP-NT":"Marcos Uriel Gonz√°lez P√©rez", "II-083-PP-NT":"Andrea Capaceta Osuna", "II-085-PP-NT":"Citlali G√≥mez M√°rquez", "II-088-PP-MC":"Karen Nayeli Hern√°ndez V√°zquez",
          "II-092-PP-GE":"Pahola del Carmen Rodr√≠guez P√©rez", "II-093-PP-NT":"Miguel Andr√©s Vald√©s Guevara", "II-097-PP-ET":"Lourdes Astrid Serrano Quilant√°n"
        };
        const ORAL_WORKS = {
            "II-017-PL-NT": "Mar√≠a Fernanda Cordero Mayorga", "II-021-PL-NT": "Anarely Ram√≠rez Hern√°ndez", "II-030-PL-ET": "Mar√≠a Jos√© Cruz P√©rez", "II-034-PL-MC": "Nadia Ortiz Rosales",
            "II-040-PL-NT": "Ana Romina Robles Guzm√°n", "II-041-PL-NT": "Natalia Edith Ram√≠rez L√≥pez", "II-042-PL-NT": "Paola Alejandra Regules Cruz", "II-056-PL-NT": "Alan Israel Cruz Bernab√©",
            "II-036-PP-NT": "Luis Jos√© Pinto Garc√≠a", // TRABAJO SUSTITUTO (D√≠a 11)
            "II-052-PP-NT": "Yanai Hern√°ndez Avenda√±o", "II-065-PP-MC": "Tahiri Alitzel Mendoza Hern√°ndez", "II-073-PP-NT": "Grisle Pe√±aloza Ram√≠rez",
            "II-074-PP-MC": "Iza Fernanda P√©rez Ram√≠rez", "II-079-PP-NT": "Samuel Salinas Ramos", "II-084-PP-MC": "Carla Arceo Cerna", "II-087-PP-NT": "Tabatta Gabriela Orejel Feria",
        };
        // ELIMINADO: II-037-PP-NT: "Zuri Abigail Gaspar Guti√©rrez", 
        
        const WORKS = {...POSTER_WORKS, ...ORAL_WORKS}; // Fusi√≥n de trabajos

        // --- ASSIGNMENTS (Combinaci√≥n de carteles y orales) ---
        // Se mantiene POSTER_ASSIGNMENTS, excepto la eliminaci√≥n del II-036-PP-NT si estaba asignado a alguien para p√≥ster (solo se asegura que no est√© en la lista general de ASSIGNMENTS)
        const POSTER_ASSIGNMENTS = {
          "araceli.hernandez": ["II-008-PL-MC","II-039-PL-MC"], "marycarmen.godinez": ["II-009-PL-MC","II-043-PL-NT","II-047-PP-NT","II-088-PP-MC"],
          "claudia.calzada": ["II-010-PL-NT","II-045-PL-NT","II-049-PP-ET","II-092-PP-GE"], "paola.zarate": ["II-012-PL-MC","II-048-PL-MC","II-068-PL-PG","II-004-PP-NT","II-053-PP-GE","II-093-PP-NT"],
          "ivonne.maciel": ["II-016-PL-NT","II-050-PL-NT","II-075-PL-NT","II-006-PP-GE","II-055-PP-MC","II-097-PP-ET"], "aldo.resendiz": ["II-020-PL-NT","II-051-PL-GE","II-076-PL-NT","II-007-PP-NT","II-057-PP-NT"],
          "javier.perez": ["II-022-PL-NT","II-054-PL-NT","II-086-PL-ET","II-011-PP-PG","II-061-PP-NT"], "paula.saldana": ["II-024-PL-NT","II-058-PL-NT","II-089-PL-ET","II-013-PP-GE","II-069-PP-NT"],
          "elena.cruz": ["II-025-PL-NT","II-059-PL-NT","II-070-PP-NT","II-091-PL-ET"], "nury.perez": ["II-027-PL-MC","II-060-PL-GE","II-094-PL-NT","II-015-PP-PG","II-072-PP-NT"],
          "enrique.mendez": ["II-029-PL-ET","II-062-PL-NT","II-095-PL-ET","II-019-PP-ET","II-081-PP-NT"], "edgar.cano": ["II-032-PL-NT","II-064-PL-NT","II-096-PL-ET","II-023-PP-GE","II-082-PP-NT"],
          "javier.flores": ["II-033-PL-ET","II-066-PL-NT","II-098-PL-NT","II-083-PP-NT"], // Se elimina II-036-PP-NT de aqu√≠ m√°s tarde si existe.
          "araceli.montoya": ["II-001-PP-NT","II-044-PP-ET","II-085-PP-NT"]
        };
        
        // CORRECCI√ìN: Asignaciones Orales
        const ORAL_ASSIGNMENTS = {
            // D√≠a 10: Aldo, Enrique, Guillermo (antes Elena)
            "aldo.resendiz": ["II-017-PL-NT", "II-021-PL-NT", "II-030-PL-ET", "II-034-PL-MC", "II-040-PL-NT", "II-041-PL-NT", "II-042-PL-NT", "II-056-PL-NT"],
            "enrique.mendez": ["II-017-PL-NT", "II-021-PL-NT", "II-030-PL-ET", "II-034-PL-MC", "II-040-PL-NT", "II-041-PL-NT", "II-042-PL-NT", "II-056-PL-NT", 
                               "II-036-PP-NT", "II-052-PP-NT", "II-065-PP-MC", "II-073-PP-NT", "II-074-PP-MC", "II-079-PP-NT", "II-084-PP-MC", "II-087-PP-NT"], // Eval√∫a todos los 16
            
            // Guillermo toma los trabajos de Elena (D√≠a 10) + sus asignaciones del D√≠a 11
            "guillermo.ceballos": [
                               "II-017-PL-NT", "II-021-PL-NT", "II-030-PL-ET", "II-034-PL-MC", "II-040-PL-NT", "II-041-PL-NT", "II-042-PL-NT", "II-056-PL-NT", // D√çA 10 (Tomado de Elena)
                               "II-036-PP-NT", "II-052-PP-NT", "II-065-PP-MC", "II-073-PP-NT", "II-074-PP-MC", "II-079-PP-NT", "II-084-PP-MC", "II-087-PP-NT"  // D√çA 11 (Original)
                            ],
            
            // D√≠a 11: Claudia y Guillermo
            "claudia.calzada": ["II-036-PP-NT", "II-052-PP-NT", "II-065-PP-MC", "II-073-PP-NT", "II-074-PP-MC", "II-079-PP-NT", "II-084-PP-MC", "II-087-PP-NT"],
            
            "elena.cruz": [] // Elena ya no tiene asignaciones orales
        };
        
        // 1. COMBINAR ASIGNACIONES
        const ASSIGNMENTS = {};
        const allJudges = new Set([...Object.keys(POSTER_ASSIGNMENTS), ...Object.keys(ORAL_ASSIGNMENTS)]);
        for (const judge of allJudges) {
            ASSIGNMENTS[judge] = [
                ...(POSTER_ASSIGNMENTS[judge] || []).filter(id => id !== "II-036-PP-NT"), // Asegurar que II-036 no est√© en poster
                ...(ORAL_ASSIGNMENTS[judge] || [])
            ].filter((v, i, a) => a.indexOf(v) === i); // Eliminar duplicados
        }
        
        // 1.1 Combinar y asegurar que el ADMIN tenga acceso a TODOS los trabajos
        // Si el usuario es "admin", asignarle todas las claves de WORKS
        ASSIGNMENTS["admin"] = Object.keys(WORKS);


        // --- CRITERIOS DE EVALUACI√ìN (Modificados para 0/5/15) ---
        const POSTER_CRITERIA = [
            // Criterios 0/5/15 (Max 15)
            { id: 'introduccion', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Introducci√≥n y Antecedentes', desc: 'Contextualizaci√≥n y justificaci√≥n del tema.' },
            { id: 'metodologia', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Metodolog√≠a', desc: 'Claridad en el dise√±o y procedimientos.' },
            { id: 'resultados', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Resultados', desc: 'Presentaci√≥n objetiva y completa de datos.' },
            
            // Criterios 0/3/5 (Max 5)
            { id: 'titulo', category: 'I. Fondo (Contenido Cient√≠fico)', max: 5, type: '3-point-discrete', name: 'T√≠tulo y Congruencia', desc: 'Claridad, pertinencia, y correcta identificaci√≥n.' },
            { id: 'conclusiones', category: 'I. Fondo (Contenido Cient√≠fico)', max: 5, type: '3-point-discrete', name: 'Conclusiones', desc: 'Consistencia con los resultados obtenidos.' },
            { id: 'banner', category: 'II. Forma (Dise√±o y Formato)', max: 5, type: 'yes-no', name: 'Banner y Elementos', desc: 'Inclusi√≥n de logos y cumplimiento de requisitos. (0 o 5 puntos)' },
            { id: 'referencias', category: 'III. Referencias y Presentaci√≥n', max: 5, type: 'yes-no', name: 'Referencias Bibliogr√°ficas', desc: 'Formato consistente y adecuado. (0 o 5 puntos)' },
            
            // Criterios 0/5/15 (Max 15)
            { id: 'diseno', category: 'II. Forma (Dise√±o y Formato)', max: 15, type: '15-point-discrete', name: 'Dise√±o y Congruencia Visual', desc: 'Equilibrio, tipograf√≠a legible y uso eficiente.' },
            { id: 'graficas', category: 'II. Forma (Dise√±o y Formato)', max: 15, type: '15-point-discrete', name: 'Uso de Tablas y Gr√°ficas', desc: 'Claridad, calidad de figuras y citaci√≥n.' }, 

            // Criterios FULL (Max 5, sin cambio)
            { id: 'defensa', category: 'III. Referencias y Presentaci√≥n', max: 5, type: 'full', name: 'Defensa y S√≠ntesis', desc: 'Dominio del tema y capacidad de s√≠ntesis.' },

            // Modificadores (sin cambio)
            { id: 'innovacion', category: 'IV. Bonificaci√≥n y Deducci√≥n', max: 15, type: 'bonus', name: 'Innovaci√≥n y Originalidad', desc: 'Aporta nuevo conocimiento o enfoque metodol√≥gico.' },
            
            // CORRECCI√ìN: Descripciones actualizadas para la deducci√≥n
            { id: 'tiempo', category: 'V. Deducci√≥n (Restan Puntos)', max: 10, type: 'deduction', name: 'Manejo del Tiempo', desc: 'Puntos de penalizaci√≥n (Se RESTAN). (M√°x. 10 (Ingresar valor positivo))' },
            { id: 'ortografia', category: 'V. Deducci√≥n (Restan Puntos)', max: 10, type: 'deduction', name: 'Redacci√≥n y Ortograf√≠a', desc: 'Puntos de penalizaci√≥n (Se RESTAN). (M√°x. 10 (Ingresar valor positivo))' },
        ];
        
        // --- CRITERIOS PARA EXPOSICI√ìN ORAL (Actualizados y Divididos) ---
        const ORAL_CRITERIA = [
            // I. Fondo (Contenido Cient√≠fico) - Max 45 puntos
            { id: 'introduccion_o', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Introducci√≥n y Antecedentes', desc: 'Contextualizaci√≥n y justificaci√≥n del tema.' },
            { id: 'metodologia_o', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Metodolog√≠a', desc: 'Claridad en el dise√±o y procedimientos.' },
            { id: 'resultados_o', category: 'I. Fondo (Contenido Cient√≠fico)', max: 15, type: '15-point-discrete', name: 'Resultados', desc: 'Presentaci√≥n objetiva y completa de datos.' },
            
            // II. Exposici√≥n Oral y Material - Max 50 puntos
            // Subdivisi√≥n del Dominio (30 pts)
            { id: 'claridad_oral', category: 'II. Exposici√≥n Oral y Material', max: 10, type: '10-point-discrete', name: 'Claridad y Estructura del Mensaje', desc: 'Organizaci√≥n l√≥gica, precisi√≥n conceptual y uso de lenguaje adecuado.' },
            { id: 'fluidez_oral', category: 'II. Exposici√≥n Oral y Material', max: 10, type: '10-point-discrete', name: 'Manejo de Tiempo y Fluidez', desc: 'Ajuste al tiempo asignado, ritmo adecuado y dicci√≥n clara.' },
            { id: 'respuestas_oral', category: 'II. Exposici√≥n Oral y Material', max: 10, type: '10-point-discrete', name: 'Capacidad de Respuesta (Q&A)', desc: 'Dominio del tema al responder preguntas y profundidad en las explicaciones.' },
            // Material Visual (10 pts)
            { id: 'material', category: 'II. Exposici√≥n Oral y Material', max: 10, type: '10-point-discrete', name: 'Calidad del Material Visual', desc: 'Dise√±o, claridad, legibilidad y apoyo visual de las diapositivas.' },
            // Criterios 0/3/5 (Max 5)
            { id: 'titulo_o', category: 'I. Fondo (Contenido Cient√≠fico)', max: 5, type: '3-point-discrete', name: 'T√≠tulo y Congruencia', desc: 'Claridad y pertinencia.' },
            { id: 'conclusiones_o', category: 'I. Fondo (Contenido Cient√≠fico)', max: 5, type: '3-point-discrete', name: 'Conclusiones', desc: 'Consistencia con los resultados obtenidos.' },
            
            // III. Referencias y √âtica (Max 5)
            { id: 'referencias_o', category: 'III. Referencias y √âtica', max: 5, type: 'yes-no', name: 'Referencias Bibliogr√°ficas', desc: 'Formato consistente y adecuado. (0 o 5 puntos)' },

            // Modificadores (sin cambio)
            { id: 'innovacion_o', category: 'IV. Bonificaci√≥n y Deducci√≥n', max: 15, type: 'bonus', name: 'Innovaci√≥n y Originalidad', desc: 'Aporta nuevo conocimiento o enfoque metodol√≥gico.' },
            
             // CORRECCI√ìN: Descripciones actualizadas para la deducci√≥n
            { id: 'tiempo_o', category: 'V. Deducci√≥n (Restan Puntos)', max: 10, type: 'deduction', name: 'Manejo del Tiempo', desc: 'Puntos de penalizaci√≥n (Se RESTAN). (M√°x. 10 (Ingresar valor positivo))' },
            { id: 'ortografia_o', category: 'V. Deducci√≥n (Restan Puntos)', max: 10, type: 'deduction', name: 'Redacci√≥n/Ortograf√≠a (Material)', desc: 'Puntos de penalizaci√≥n (Se RESTAN). (M√°x. 10 (Ingresar valor positivo))' },
        ];


        let currentUser = null;
        let currentRole = null;
        let currentJudge = null;
        
        // --- L√≥gica del Sistema ---

        // Funci√≥n para alternar la visibilidad de la contrase√±a en el login
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('password');
            const toggleBtn = document.getElementById('toggle-password-btn');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.textContent = 'üôà'; // Ojo tachado
            } else {
                passwordInput.type = 'password';
                toggleBtn.textContent = 'üëÅÔ∏è'; // Ojo
            }
        }
        
        // Helper para obtener el set de criterios
        function getCriteriaSet(workId) {
            if (ORAL_WORKS.hasOwnProperty(workId)) {
                return ORAL_CRITERIA;
            }
            return POSTER_CRITERIA;
        }


        // Funci√≥n auxiliar para calcular el puntaje total
        function calculateScore(workId) {
            const criteriaSet = getCriteriaSet(workId);
            const form = document.getElementById('eval-form');
            if (!form) return 0;

            let totalScore = 0;
            let totalBonus = 0;
            let totalDeduction = 0;

            for (const item of criteriaSet) {
                let score = 0;
                
                if (item.type.includes('discrete')) {
                    const hiddenInput = document.getElementById(`${item.id}-score-hidden`);
                    score = parseInt(hiddenInput ? hiddenInput.value : 0) || 0;
                } else if (item.type === 'yes-no') {
                    const select = document.querySelector(`select[name="${item.id}"]`);
                    score = parseInt(select ? select.value : 0) || 0;
                } else {
                    const numberInput = document.getElementById(`${item.id}-score`);
                    if (numberInput) {
                        score = parseFloat(numberInput.value) || 0;
                    }
                }
                
                // Las categor√≠as de deducci√≥n deben ser tratadas como valores que restan.
                if (item.type === 'deduction') {
                    // Restamos el valor POSITIVO ingresado por el usuario (Math.abs(score))
                    totalDeduction -= Math.abs(score); 
                } 
                else if (item.type === 'bonus') {
                    // Aseguramos que solo sume valores positivos o cero
                    totalBonus += Math.max(0, score);
                } 
                else {
                    // Aseguramos que solo sume valores positivos o cero
                    totalScore += Math.max(0, score);
                }
            }
            
            // El c√°lculo final ahora es simplemente la suma (las deducciones ya est√°n incluidas como negativos)
            let finalScore = totalScore + totalBonus + totalDeduction;

            // Aseguramos que el puntaje final no sea negativo.
            if (finalScore < 0) finalScore = 0;

            const scoreDisplay = document.getElementById('total-score-display');
            if (scoreDisplay) scoreDisplay.textContent = finalScore;
            
            return finalScore;
        }

        // --- Manejo de la Evaluaci√≥n ---
        async function saveEvaluation(id) {
            const criteriaSet = getCriteriaSet(id);
            const fd = new FormData(document.getElementById("eval-form"));
            const scores = {};
            
            // 1. Recoger puntajes detallados
            for (const item of criteriaSet) {
                let score = 0;
                
                if (item.type.includes('discrete')) {
                    const hiddenInput = document.getElementById(`${item.id}-score-hidden`);
                    score = parseInt(hiddenInput ? hiddenInput.value : 0) || 0;
                } else if (item.type === 'yes-no') {
                    const select = document.querySelector(`select[name="${item.id}"]`);
                    score = parseInt(select ? select.value : 0) || 0;
                } else if (item.type === 'deduction') {
                    // Para deducci√≥n, leemos el valor positivo que ingres√≥ el usuario
                    const numberInput = document.getElementById(`${item.id}-score`);
                    let inputVal = parseFloat(numberInput ? numberInput.value : 0) || 0;
                    
                    // GUARDAMOS EL VALOR COMO NEGATIVO (Si ingresan 10, guardamos -10)
                    score = -Math.abs(inputVal); 
                } else {
                    // Para full/bonus, aseguramos que sea positivo
                    const numberInput = document.getElementById(`${item.id}-score`);
                    score = Math.max(0, parseFloat(numberInput ? numberInput.value : 0) || 0);
                }
                
                scores[item.id] = score; // Guardar el valor (NEGATIVO para deducci√≥n)
            }

            const totalScore = calculateScore(id); // Obtener el puntaje final calculado

            const payload = {
                timestamp: new Date().toISOString(),
                staticJudgeId: currentUser, 
                judgeName: currentJudge.name,
                posterId: id,
                posterTitle: WORKS[id] || "T√≠tulo Desconocido",
                type: ORAL_WORKS.hasOwnProperty(id) ? "Oral" : "Poster",
                totalScore: totalScore,
                scores: scores,
                observations: fd.get("comentarios") || ""
            };

            // 2. Guardar Localmente y Bloquear
            localStorage.setItem(`eval_${currentUser}_${id}`, JSON.stringify(payload));

            // 3. Enviar a Google Sheets
            try {
                const response = await fetch(SHEETS_WEBAPP_URL, {
                    method:"POST",
                    body: JSON.stringify(payload)
                });

                if (response.ok || response.type === 'opaque') {
                    console.log("Env√≠o a Google Sheets iniciado o exitoso.");
                    showAlert("Evaluaci√≥n guardada y enviada a Sheets.", "success");
                } else {
                    const errorText = await response.text();
                    console.warn("Fallo al enviar a Sheets (Respuesta no OK):", errorText);
                    showAlert("Error al enviar a Sheets, pero guardado localmente. (Verificar la URL del Apps Script y el CORS)", "error");
                }
                
            } catch(e){ 
                console.warn("Fallo en la petici√≥n a Sheets (posible problema de red/CORS):", e); 
                showAlert("Error de conexi√≥n al enviar a Sheets, pero guardado localmente. (Verificar la URL del Apps Script y el CORS)", "error");
            }

            showDashboard();
        }

        // --- Reiniciar Evaluaci√≥n (Funciones de soporte) ---
        function confirmResetEvaluation(id) {
            const student = WORKS[id] || "Desconocido";
            openModal(`
                <h3>üîÑ Confirmar Reinicio de Evaluaci√≥n</h3>
                <p class="muted">¬øEst√° seguro de que desea reiniciar la evaluaci√≥n para el trabajo <strong>${id}</strong> (${student})? Esto borrar√° el puntaje guardado localmente.</p>
                <button class="btn danger" style="width:100%" onclick="resetEvaluation('${id}')">
                    üóëÔ∏è S√≠, Borrar y Reiniciar Evaluaci√≥n
                </button>
            `);
        }
        
        function resetEvaluation(id) {
            closeModal();
            const key = `eval_${currentUser}_${id}`;
            localStorage.removeItem(key);
            showAlert(`Evaluaci√≥n del trabajo ${id} reiniciada.`, "info");
            showDashboard();
        }
        
        // --------------------------------------------------------
        //  FUNCIONES PARA IMPRIMIR HOJA DE EVALUACI√ìN (NUEVO)
        // --------------------------------------------------------
        function openPrintModal() {
             openModal(`
                <h3>Seleccionar Hoja de Evaluaci√≥n</h3>
                <p class="muted">Elige el formato de hoja de evaluaci√≥n que deseas imprimir (se abrir√° una nueva ventana).</p>
                <button class="btn primary" style="width: 100%; margin-top: 15px;" onclick="printEvaluationSheet()">
                    üñ®Ô∏è Imprimir Formato (P√≥ster/Oral)
                </button>
            `);
        }
        
        function printEvaluationSheet() {
            // Abrimos una ventana nueva y escribimos el contenido HTML imprimible en ella
            const printWindow = window.open('', '_blank');
            printWindow.document.write(PRINTABLE_HTML_TEMPLATE);
            printWindow.document.close();
            closeModal();
        }
        // --------------------------------------------------------

        // --- Render Judge Dashboard ---
        function renderJudge(){
          const root = document.getElementById("app-root");
          const posterWorks = Object.keys(POSTER_WORKS).filter(id => (ASSIGNMENTS[currentUser] || []).includes(id));
          const oralWorks = Object.keys(ORAL_WORKS).filter(id => (ASSIGNMENTS[currentUser] || []).includes(id));

          // Icono de Juez: üßë‚Äç‚öñÔ∏è
          let html = `<div class="header-row"><div><div class="welcome">üßë‚Äç‚öñÔ∏è Bienvenido, ${currentJudge.name}</div><div class="small">Juez: ${currentUser}</div></div><div class="top-actions">
          <button class="btn ghost" onclick="openPrintModal()">üñ®Ô∏è Imprimir Hoja</button>
          <button class="btn ghost" onclick="logout()">üö™ Cerrar sesi√≥n</button></div></div>`;
          
          html += `<div class="tabs">
                       <button class="tab-button active" onclick="showWorkList('poster-list', this)">Trabajos P√≥ster (${posterWorks.length})</button>
                       <button class="tab-button" onclick="showWorkList('oral-list', this)">Exposiciones Orales (${oralWorks.length})</button>
                   </div>`;

          // --- Lista de Posters ---
          html += `<div id="poster-list" class="work-list-container">
                    <div class="card"><h3 class="small">Mis Trabajos Asignados (P√≥ster)</h3>`;
          if(posterWorks.length === 0) html += `<p class="small">No tiene trabajos P√≥ster asignados.</p>`;
          html += `<div class="work-list">`;
          html += renderWorkCards(posterWorks);
          html += `</div></div></div>`;

          // --- Lista de Orales (Oculta por defecto) ---
          html += `<div id="oral-list" class="work-list-container hidden">
                    <div class="card"><h3 class="small" style="color: var(--info);">Mis Trabajos Asignados (Oral)</h3>`;
          if(oralWorks.length === 0) html += `<p class="small">No tiene exposiciones Orales asignadas.</p>`;
          html += `<div class="work-list">`;
          html += renderWorkCards(oralWorks);
          html += `</div></div></div>`;

          root.innerHTML = html;
        }

        function renderWorkCards(workIds) {
            let html = '';
            for(const id of workIds){
                const student = WORKS[id] || "";
                const doneKey = `eval_${currentUser}_${id}`;
                const data = localStorage.getItem(doneKey);
                const done = data ? true : false;
                let totalScore = "N/A";

                if (done) {
                    try {
                        const obj = JSON.parse(data);
                        totalScore = obj.totalScore || 0;
                    } catch (e) { /* silent fail */ }
                }

                html += `<div class="work-card">
                            <strong>${id}</strong>
                            <div class="work-meta">${student}</div>
                            <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
                                ${done ? 
                                    `<span class="evaluated-badge">‚úÖ Finalizado (${totalScore} Pts)</span>
                                     <button class="btn ghost" style="width:auto; padding: 8px 10px; font-size:12px; color: var(--danger);" onclick="confirmResetEvaluation('${id}')">üîÑ Reiniciar</button>`
                                    : `<button class="btn primary" onclick="openEvaluation('${id}')">üìù Evaluar</button>`}
                            </div>
                         </div>`;
            }
            return html;
        }
        
        function showWorkList(listId, buttonElement) {
            document.querySelectorAll('.work-list-container').forEach(el => el.classList.add('hidden'));
            document.getElementById(listId).classList.remove('hidden');

            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            buttonElement.classList.add('active');
        }


        // --- Componentes de Botones de Evaluaci√≥n ---
        const DISCRETE_GUIDANCE = {
            '15-point-discrete': {
                '0': { emoji: 'üî¥', label: '0 Pts', tip: '‚ùå NO CUMPLE: No se presenta la informaci√≥n o la secci√≥n es incoherente/faltante. Evaluaci√≥n nula.' },
                '5': { emoji: 'üü†', label: '5 Pts', tip: '‚ö†Ô∏è BAJO: Cumple m√≠nimamente. La informaci√≥n es b√°sica, incompleta o presenta errores conceptuales/metodol√≥gicos.' },
                '15': { emoji: 'üü¢', label: '15 Pts', tip: '‚úÖ EXCELENTE: Cumple totalmente los requisitos. Informaci√≥n clara, precisa, completa y bien organizada.' }
            },
            '10-point-discrete': {
                '0': { emoji: 'üî¥', label: '0 Pts', tip: '‚ùå NO CUMPLE: Totalmente deficiente en el aspecto evaluado.' },
                '5': { emoji: 'üü†', label: '5 Pts', tip: '‚ö†Ô∏è REGULAR: Presenta deficiencias notables en la organizaci√≥n, claridad, o manejo del tiempo/preguntas.' },
                '10': { emoji: 'üü¢', label: '10 Pts', tip: '‚úÖ EXCELENTE: Criterio cubierto con alta calidad. Comunicaci√≥n efectiva, estructura s√≥lida y dominio total.' }
            },
            '3-point-discrete': {
                '0': { emoji: 'üî¥', label: '0 Pts', tip: '‚ùå NO CUMPLE: La secci√≥n es totalmente deficiente o no es adecuada (ej. T√≠tulo irrelevante).' },
                '3': { emoji: 'üü†', label: '3 Pts', tip: '‚ö†Ô∏è ADECUADO: Cumple con la funci√≥n, pero podr√≠a ser m√°s conciso o pertinente.' },
                '5': { emoji: 'üü¢', label: '5 Pts', tip: '‚úÖ EXCELENTE: Criterio totalmente cubierto con m√°xima claridad y relevancia.' }
            }
        };

        function renderDiscreteScoreButtons(item, currentScore, workId) {
            const guidance = DISCRETE_GUIDANCE[item.type];
            if (!guidance) return '';

            let buttonsHtml = '';
            
            // Hidden input para almacenar el valor seleccionado
            buttonsHtml += `<input type="hidden" id="${item.id}-score-hidden" value="${currentScore}" onchange="calculateScore('${workId}')">`;

            for (const value in guidance) {
                const info = guidance[value];
                const isSelected = currentScore == value ? 'selected' : '';

                buttonsHtml += `
                    <button type="button" 
                        class="score-btn ${isSelected}" 
                        data-score="${value}" 
                        onclick="setDiscreteScore('${item.id}', ${value}, '${workId}')">
                        ${info.emoji} ${info.label}
                        <span class="tooltip">${value} Pts: ${info.tip}</span>
                    </button>
                `;
            }

            return `<div class="score-buttons">${buttonsHtml}</div>`;
        }

        window.setDiscreteScore = function(itemId, score, workId) {
            // 1. Deseleccionar todos los botones y seleccionar el nuevo
            // Usamos querySelectorAll en el contexto de la tarjeta (eval-card) para evitar conflictos con otros botones
            document.querySelectorAll(`.eval-card [data-score]`).forEach(btn => btn.classList.remove('selected'));

            // 2. Seleccionar el bot√≥n correcto
            const selectedButton = document.querySelector(`.eval-card [data-score="${score}"]`);
            if (selectedButton) {
                selectedButton.classList.add('selected');
            }


            // 3. Actualizar el input hidden
            const hiddenInput = document.getElementById(`${itemId}-score-hidden`);
            if (hiddenInput) {
                hiddenInput.value = score;
                // Disparar manualmente el evento change para recalcular el puntaje total
                calculateScore(workId);
            }
        }


        // --- Render Evaluation Form ---
        function openEvaluation(id){
            const student = WORKS[id] || "";
            const criteriaSet = getCriteriaSet(id); 
            const existingData = localStorage.getItem(`eval_${currentUser}_${id}`);
            const data = existingData ? JSON.parse(existingData) : {};
            const scores = data.scores || {};
            const modality = ORAL_WORKS.hasOwnProperty(id) ? "Exposici√≥n Oral" : "P√≥ster Cient√≠fico";


            let criteriaHtml = '';
            let currentCategory = '';

            criteriaSet.forEach(item => {
                if (item.category !== currentCategory) {
                    criteriaHtml += `<h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">${item.category}</h4>`;
                    currentCategory = item.category;
                }

                let inputField = '';
                // Recuperamos el score. Si es deducci√≥n, Math.abs() nos da el valor positivo para mostrar en la UI.
                let currentScore = scores[item.id] !== undefined ? scores[item.id] : 0;
                
                // Si es deducci√≥n, mostramos el valor positivo en el input para que el usuario no se confunda con el signo
                let displayValue = item.type === 'deduction' ? Math.abs(currentScore) : currentScore;
                
                
                if (item.type.includes('discrete')) {
                    // Usar botones de escala discreta (0/5/15 o 0/3/5)
                    inputField = renderDiscreteScoreButtons(item, currentScore, id);
                } else if (item.type === 'yes-no') {
                     // Mantener select para s√≠/no (0/5)
                     inputField = `
                         <div class="score-row">
                            <label class="small">${item.desc}</label>
                            <div style="display:flex; gap: 8px;">
                                <select name="${item.id}" class="score-input-custom" required onchange="calculateScore('${id}')">
                                    <option value="">--</option>
                                    <option value="0" ${currentScore == 0 ? 'selected' : ''}>No (0)</option>
                                    <option value="5" ${currentScore == 5 ? 'selected' : ''}>S√≠ (5)</option>
                                </select>
                            </div>
                        </div>
                     `;
                } else {
                    // Input Num√©rico (Full, Bonus, Deduction)
                    const classType = item.type === 'deduction' ? 'deduction' : (item.type === 'bonus' ? 'bonus' : '');
                    const placeholderText = item.type === 'deduction' ? `M√°x. ${item.max} (Ingresar valor positivo)` : `M√°x. ${item.max}`;

                    inputField = `
                        <div class="score-row ${classType}">
                           <label class="small">${item.desc} (${placeholderText})</label>
                           <input type="number" id="${item.id}-score" name="${item.id}" class="score-input-custom" 
                                   min="${item.type === 'deduction' ? 0 : 0}" 
                                   max="${item.type === 'deduction' ? item.max : item.max}" 
                                   value="${displayValue}" 
                                   oninput="calculateScore('${id}')">
                        </div>
                    `;
                }
                
                criteriaHtml += `<div class="eval-card"><strong>${item.name}</strong>${inputField}</div>`;
            });


            const root = document.getElementById("app-root");
            root.innerHTML = `<div class="card"><button class="btn ghost" onclick="showDashboard()">‚Üê Volver al Panel</button>
                <h3>üìù Evaluaci√≥n de ${modality}</h3>
                <div class="small">${id} ‚Äî ${student}</div>
                <div style="margin-top:15px; font-size: 20px; font-weight: 800; color: var(--primary-1);">
                    Puntuaci√≥n Total: <span id="total-score-display">${data.totalScore || 0}</span> / 100
                </div>

                <form id="eval-form" style="margin-top:16px">
                    <div class="eval-grid">${criteriaHtml}</div>
                    
                    <div style="margin-top:20px; border-top: 1px solid #eee; padding-top: 16px;">
                        <label>‚úçÔ∏è Observaciones/Comentarios</label>
                        <textarea name="comentarios" rows="4">${data.observations || ''}</textarea>
                    </div>

                    <div style="margin-top:20px;display:flex;gap:10px">
                        <button class="btn primary" type="submit">‚úÖ Guardar evaluaci√≥n (Finalizar)</button>
                        <button type="button" class="btn ghost" onclick="showDashboard()">‚ùå Cancelar</button>
                        <button type="button" class="btn danger" style="width: auto;" onclick="confirmResetEvaluation('${id}')">üóëÔ∏è Reiniciar Evaluaci√≥n</button>
                    </div>
                </form>
            </div>`;

            // Re-bind events for score calculation on input change
            document.getElementById("eval-form").addEventListener("input", () => calculateScore(id));
            document.getElementById("eval-form").addEventListener("change", () => calculateScore(id));
            
            // Asegurarse de que los botones seleccionados se muestren al cargar la evaluaci√≥n
            criteriaSet.forEach(item => {
                if (item.type.includes('discrete')) {
                     const currentScore = scores[item.id] !== undefined ? scores[item.id] : 0;
                     const hiddenInput = document.getElementById(`${item.id}-score-hidden`);
                     if (hiddenInput && currentScore) {
                        const selector = `#app-root [data-score="${currentScore}"]`;
                        const selectedButton = document.querySelector(selector);
                        if(selectedButton) {
                            selectedButton.classList.add('selected');
                        }
                     }
                }
            });


            document.getElementById("eval-form").addEventListener("submit", e=>{
                e.preventDefault();
                saveEvaluation(id);
            });
            calculateScore(id); // Initial calculation
        }
        
        // --- Funciones de Login y Admin Dashboard (sin cambios) ---

        function tryLogin(){
          const u = document.getElementById("username").value.trim();
          const p = document.getElementById("password").value.trim();
          const err = document.getElementById("login-error");
          err.classList.add("hidden"); err.textContent = "";

          const match = USERS.find(x => x.user === u && x.pass === p);
          if(!match){
            err.textContent = "Usuario o contrase√±a incorrectos.";
            err.classList.remove("hidden");
            return;
          }

          currentUser = match.user; currentRole = match.role; currentJudge = match;
          localStorage.setItem("simposioUser", currentUser); localStorage.setItem("simposioRole", currentRole);

          showDashboard();
        }

        window.addEventListener("load", () => {
          const u = localStorage.getItem("simposioUser");
          const r = localStorage.getItem("simposioRole");
          if(u && r){
            currentUser = u; currentRole = r; currentJudge = USERS.find(x=>x.user===u);
            showDashboard();
          }
        });

        function showDashboard(){
          const loginCard = document.getElementById("login-card");
          if(loginCard) loginCard.classList.add("hidden");
          const root = document.getElementById("app-root");
          root.classList.remove("hidden");
          if(currentRole === "admin") renderAdmin();
          else renderJudge();
        }

        
        function renderAdmin(){
          const root = document.getElementById("app-root");
          // Icono de Admin: ‚öôÔ∏è
          let html = `<div class="header-row"><div><div class="welcome">‚öôÔ∏è Panel de Administraci√≥n</div><div class="small">Usuario: ${currentJudge.name}</div></div><div class="top-actions">
          <button class="btn ghost" onclick="showPasswordsModal()">üîë Ver Contrase√±as</button>
          <button class="btn primary" onclick="exportGlobalCSV()">üíæ Exportar Global CSV</button>
          <button class="btn ghost" onclick="logout()">üö™ Cerrar sesi√≥n</button></div></div>`;
          html += `<div class="card"><h3 class="small">Progreso por juez</h3><div class="admin-grid">`;
          
          for(const u of USERS.filter(x=>x.role==="juez")){
            const assigned = ASSIGNMENTS[u.user] || [];
            let done = 0;
            for(const id of assigned) {
                const data = localStorage.getItem(`eval_${u.user}_${id}`);
                if(data && !JSON.parse(data).reassignedFrom) done++; 
            }
            const pct = assigned.length? Math.round(done/assigned.length*100) : 0;
            
            html += `<div class="work-card">
                        <strong>${u.name}</strong>
                        <div class="small">${done}/${assigned.length} completados</div>
                        <div style="margin-top:10px" class="progress"><div style="width:${pct}%"></div></div>
                        <div style="margin-top:15px; display:flex; gap:8px;">
                            <button class="btn ghost" style="width:auto; padding: 10px 14px; font-size:14px;" onclick="openReassignModal('${u.user}')">üì§ Reasignar</button>
                            <button class="btn primary" style="width:auto; padding: 10px 14px; font-size:14px;" onclick="exportJudgeCSV('${u.user}')">CSV</button>
                        </div>
                     </div>`;
          }
          html += `</div></div>`;
          
          // Agregamos el bot√≥n para que el administrador pueda ver el panel de juez y calificar si es necesario
          html += `<div class="card" style="margin-top: 20px;">
                      <h3 class="small">Acceso R√°pido y Herramientas</h3>
                      <button class="btn primary" style="width: 100%; margin-top: 10px;" onclick="renderJudge()">üìù Acceder al Panel de Calificaci√≥n</button>
                      <button class="btn ghost" style="width: 100%; margin-top: 10px;" onclick="openPrintModal()">üñ®Ô∏è Imprimir Hoja de Evaluaci√≥n (Respaldo)</button>
                   </div>`;

          root.innerHTML = html;
        }

        // --- Admin: Mostrar Contrase√±as ---
        function showPasswordsModal() {
            let userListHtml = USERS.map(u => `
                <div style="display:flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px dotted #eee;">
                    <span><strong>${u.user}</strong> (${u.name})</span>
                    <span style="font-family: monospace; font-size:15px; background: #f3f4f6; padding: 4px 8px; border-radius: 6px;">${u.pass}</span>
                </div>
            `).join('');

            openModal(`
                <h3>üîë Contrase√±as de Jueces y Administrador</h3>
                <p class="muted">Lista para referencia del administrador. Por favor, maneje esta informaci√≥n con discreci√≥n.</p>
                <div style="max-height: 400px; overflow-y: auto; margin-top: 20px; padding: 0 5px;">
                    ${userListHtml}
                </div>
            `);
        }

        // --- Reassignment Logic (Modal) ---
        function openReassignModal(oldJudge){
          const listaJueces = USERS
              .filter(u => u.role === "juez" && u.user !== oldJudge)
              .map(j => `<option value="${j.user}">${j.name} (${j.user})</option>`)
              .join("");

          openModal(`
              <h3>üì§ Reasignar Trabajos Pendientes</h3>
              <p class="muted">Transfiere los trabajos *no evaluados* de <strong>${oldJudge}</strong> a otro juez.</p>
              
              <label for="newJudgeSelect">Nuevo Juez</label>
              <select id="newJudgeSelect" style="margin-bottom: 12px; width:100%">
                  <option value="">Seleccione...</option>
                  ${listaJueces}
              </select>
              
              <button class="btn primary" style="width:100%" onclick="confirmMassReassign('${oldJudge}')">
                  Confirmar Reasignaci√≥n Masiva
              </button>
          `);
        }

        function confirmMassReassign(oldJudge){
          const newJudge = document.getElementById("newJudgeSelect").value;
          if(!newJudge){
            showAlert("Debe seleccionar un juez v√°lido para la reasignaci√≥n.", "error");
            return;
          }
          reassignAllPending(oldJudge, newJudge);
          closeModal();
        }

        function reassignAllPending(oldJudge, newJudge){
          const assignedByOldJudge = ASSIGNMENTS[oldJudge] || [];
          let pendingToReassign = [];
          
          for(const id of assignedByOldJudge){
            const key = `eval_${oldJudge}_${id}`;
            const data = localStorage.getItem(key);
            if(!data || (data && JSON.parse(data).reassignedFrom)){ 
              pendingToReassign.push(id);
            }
          }

          let count = 0;
          let newAssignments = [];
          
          for(const id of pendingToReassign){
              const newKey = `eval_${newJudge}_${id}`;
              const newJudgeEvaluated = localStorage.getItem(newKey) && !JSON.parse(localStorage.getItem(newKey)).reassignedFrom;
              
              if(!newJudgeEvaluated) {
                  localStorage.setItem(newKey, JSON.stringify({reassignedFrom: oldJudge, timestamp:new Date().toISOString(), totalScore: 0}));
                  newAssignments.push(id);
                  count++;
              }
          }
          
          ASSIGNMENTS[oldJudge] = assignedByOldJudge.filter(id => !pendingToReassign.includes(id));
          ASSIGNMENTS[newJudge] = (ASSIGNMENTS[newJudge] || []).concat(newAssignments.filter(id => !(ASSIGNMENTS[newJudge] || []).includes(id)));
          
          showAlert(`Reasignados ${count} trabajos pendientes de ${oldJudge} a ${newJudge}.`, "success");
          renderAdmin(); 
        }

        // --- UI Utils ---
        function openModal(html) {
            const modal = document.createElement("div");
            modal.className = "modal-bg";
            modal.innerHTML = `<div class="modal card">${html}<button class="btn ghost" style="margin-top:20px; width:100%" onclick="closeModal()">Cerrar</button></div>`;
            document.body.appendChild(modal);
        }

        function closeModal() {
            const m = document.querySelector(".modal-bg");
            if (m) m.remove();
        }

        // REEMPLAZO DE ALERT Y PROMPT NATIVOS
        function showAlert(message, type = "info") {
            const alertBox = document.getElementById("custom-alert");
            if (!alertBox) return;

            alertBox.textContent = message;
            alertBox.className = ''; 
            alertBox.classList.add('alert-' + type);
            alertBox.style.display = 'block';

            void alertBox.offsetWidth; 
            alertBox.style.opacity = 1;

            setTimeout(() => {
                alertBox.style.opacity = 0;
                setTimeout(() => {
                    alertBox.style.display = 'none';
                }, 300); 
            }, 3000); 
        }

        // --- CSV Exports (Actualizado con todos los criterios) ---
        // La exportaci√≥n ahora usa el set completo de criterios (Posters + Orales)
        function exportGlobalCSV(){
          const allCriteria = [...POSTER_CRITERIA, ...ORAL_CRITERIA.filter(oc => !POSTER_CRITERIA.some(pc => pc.id === oc.id))]; // Combinar sets √∫nicos
          const baseHeaders = ['judge', 'work', 'student', 'type', 'totalScore', 'observations', 'timestamp'];
          const criteriaHeaders = allCriteria.map(c => c.id);
          const headers = baseHeaders.concat(criteriaHeaders);
          const rows = [headers];
          
          for(const u of USERS.filter(x=>x.role==="juez")){
            const assigned = ASSIGNMENTS[u.user] || [];
            for(const id of assigned){
              const key = `eval_${u.user}_${id}`;
              const data = localStorage.getItem(key);
              if(data){
                const obj = JSON.parse(data);
                
                let row = [
                    u.user, id, WORKS[id] || "", obj.type || (ORAL_WORKS.hasOwnProperty(id) ? "Oral" : "Poster"), obj.totalScore || 0, 
                    obj.observations || "", obj.timestamp || ""
                ];

                // Agregar todos los puntajes de criterios, usando 0 si el ID del criterio no existe en la evaluaci√≥n guardada
                for (const item of allCriteria) {
                    row.push(obj.scores?.[item.id] !== undefined ? obj.scores[item.id] : 0);
                }
                
                rows.push(row);
              }
            }
          }
          downloadCSV(rows,"evaluaciones_global.csv");
          showAlert("Exportaci√≥n CSV Global iniciada.", "info");
        }

        function exportJudgeCSV(judge){
          const allCriteria = [...POSTER_CRITERIA, ...ORAL_CRITERIA.filter(oc => !POSTER_CRITERIA.some(pc => pc.id === oc.id))]; 
          const baseHeaders = ['work', 'student', 'type', 'totalScore', 'observations', 'timestamp'];
          const criteriaHeaders = allCriteria.map(c => c.id);
          const headers = baseHeaders.concat(criteriaHeaders);
          const rows = [headers];
          const assigned = ASSIGNMENTS[judge] || [];
          
          for(const id of assigned){
            const key = `eval_${judge}_${id}`;
            const data = localStorage.getItem(key);
            if(data){
              const obj = JSON.parse(data);

              let row = [
                  id, WORKS[id] || "", obj.type || (ORAL_WORKS.hasOwnProperty(id) ? "Oral" : "Poster"), obj.totalScore || 0, 
                  obj.observations || "", obj.timestamp || ""
              ];

              for (const item of allCriteria) {
                  row.push(obj.scores?.[item.id] !== undefined ? obj.scores[item.id] : 0);
              }

              rows.push(row);
            }
          }
          downloadCSV(rows,`evaluaciones_${judge}.csv`);
          showAlert(`Exportaci√≥n CSV para ${judge} iniciada.`, "info");
        }


        function downloadCSV(rows,filename){
          const csv = rows.map(r=>r.map(c=>`"${String(c).replace(/"/g,"'")}"`).join(",")).join("\n");
          const blob = new Blob([csv],{type:"text/csv"});
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a"); a.href=url; a.download=filename; a.click();
          URL.revokeObjectURL(url);
        }
        
        function logout(){ localStorage.removeItem("simposioUser"); localStorage.removeItem("simposioRole"); location.reload(); }

        // --- Exposici√≥n Global de Funciones para HTML ---
        window.showDashboard = showDashboard;
        window.renderJudge = renderJudge;
        window.openEvaluation = openEvaluation;
        window.saveEvaluation = saveEvaluation;
        window.renderAdmin = renderAdmin;
        window.showPasswordsModal = showPasswordsModal; 
        window.confirmResetEvaluation = confirmResetEvaluation; 
        window.resetEvaluation = resetEvaluation; 
        window.openReassignModal = openReassignModal;
        window.confirmMassReassign = confirmMassReassign;
        window.reassignAllPending = reassignAllPending;
        window.exportGlobalCSV = exportGlobalCSV;
        window.exportJudgeCSV = exportJudgeCSV;
        window.calculateScore = calculateScore;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.showAlert = showAlert;
        window.logout = logout;
        window.togglePasswordVisibility = togglePasswordVisibility; 
        window.showWorkList = showWorkList;
        window.setDiscreteScore = setDiscreteScore;
        window.openPrintModal = openPrintModal; // Expuesto para el bot√≥n de impresi√≥n
        window.printEvaluationSheet = printEvaluationSheet;


        // Inicializar eventos al cargar la ventana
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("login-btn").addEventListener("click", tryLogin);
            
            // ELIMINANDO PRELLENADO DE CREDENCIALES para producci√≥n
            // document.getElementById("username").value = "araceli.hernandez";
            // document.getElementById("password").value = "Simposio2025"; 
        });
    </script>
</head>
<body>
  
  <!-- Custom Alert/Toast Container -->
  <div id="custom-alert" class="alert-info"></div>

  <div class="container">
    <header class="topbar">
      <div class="left">
        <!-- Logos reales de Github -->
        <img src="logo_ipn.png" onerror="this.src='https://placehold.co/50x50/5b21b6/FFFFFF/png?text=IPN'" alt="IPN" class="logo" />
        <img src="logo_esm.jpg" onerror="this.src='https://placehold.co/50x50/059669/FFFFFF/png?text=ESM'" alt="ESM" class="logo" />
        <img src="logo_licam.png" onerror="this.src='https://placehold.co/50x50/34d399/000000/png?text=LICAM'" alt="LICAM" class="logo" />
      </div>
      <div class="right">
        <div class="version">Simposio ‚Ä¢ Evaluaci√≥n ‚Ä¢ 2025</div>
      </div>
    </header>

    <main class="main-grid">
      <!-- PANEL DE INICIO DE SESI√ìN -->
      <aside class="login-card card" id="login-card">
        <h2>Bienvenido al Sistema</h2>
        <p class="muted">Usa el usuario y contrase√±a asignado para iniciar la evaluaci√≥n.</p>

        <label for="username">Usuario</label>
        <input id="username" type="text" autocomplete="username" placeholder="ej. usuario.juez">

        <label for="password">Contrase√±a</label>
        <div class="password-container">
            <input id="password" type="password" autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            <button type="button" class="toggle-btn" id="toggle-password-btn" onclick="togglePasswordVisibility()">
                üëÅÔ∏è
            </button>
        </div>

        <div id="login-error" class="error hidden"></div>

        <button id="login-btn" class="btn primary">üöÄ Entrar</button>

        <small class="muted" style="margin-top:10px;">Si tiene problemas contacte al administrador.</small>
      </aside>

      <!-- RA√çZ DE LA APLICACI√ìN (Dashboard / Evaluaci√≥n) -->
      <section id="app-root" class="card hidden"></section>
    </main>

    <footer class="footer">
      ¬© Simposio 2025 ‚Äî Plataforma de Evaluaci√≥n
    </footer>
  </div>
</body>
</html>
